<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="../SalsaVerde/bundle.css" />
</head>

<body>
    <div id="myapp">
        <h1>{{ title }}</h1>
        <p>{{ data }}</p>
        <button _click="setAlert('messaggio da evento')">{{ tasto }}</button>
        <button name="ciccio" _on="click -> changeTitle(e);">switch title</button>
        <button _click=".conto += 1"> Conto dinamico: {{ conto }}</button>
        <br />
        <br />
        <button _click="addItem()">Aggiungi</button>
        <button _click="removeLast()">Rimuovi</button>
        <div style="display:flex; flex-direction:row;">
            <ul _for="item in lista" _if=".conto > 3">
                <li data-value="{{ item.id }}" name="{{ :index }}">{{ item.name }} - {{ conto }}</li>
            </ul>
            <ul _for="item in semplice" _else>
                <li>{{ item }} {{ :index }}</li>
            </ul>
        </div>
        <ol _for="item in lista">
            <li>{{ item.name }}</li>
        </ol>
    </div>
    <script src="../SalsaVerde/salsaverde.global.js"></script>
    <script name="app_test" type="text/javascript">

        var myapp;
        openKiosk("myapp").reserve({
            data: {
                title: "Applicazione di prova",
                tasto: "testo del tasto",
                data: new Date(),
                conto: 0,
                lista: [
                    { id: 1, name: "elemento 1" },
                    { id: 2, name: "elemento 2" },
                    { id: 3, name: "elemento 3" },
                    { id: 4, name: "elemento 4" }
                ],
                semplice: ["ciao", "ciao", "ciao"]
            },
            settings: {
                formatter: {
                    type: svenum.datatypes.date,
                    stamp: (value) => {
                        let _options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                        return value.toLocaleDateString("it-IT", _options);
                    }
                }
            }
        }).globalize({ myapp });

        function setAlert(messaggio) {
            svglobal.claim(messaggio);
        }
        function changeTitle(evt) {
            // alert(evt.target.getAttribute("name"));
            switch (myapp.dataset.title) {
                case "Cambio titolo!": myapp.dataset.title = "Applicazione di prova"; break;
                case "Applicazione di prova": myapp.dataset.title = "Cambio titolo!"; break;
            }
        }

        function addItem() {
            myapp.dataset.lista.push({ id: myapp.dataset.lista.length + 1, name: "elemento " + (myapp.dataset.lista.length + 1).toString() });
            myapp.dataset.semplice.push("ciao");
        }
        function removeLast() {
            myapp.dataset.lista.pop();
            myapp.dataset.semplice.pop();
        }

    </script>
</body>

</html>