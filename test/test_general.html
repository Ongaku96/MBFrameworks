<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="../SalsaVerde/bundle.css" />
    <style>
        .usato{
            background-color: darkgrey;
        }
        .nuovo{
            background-color: aquamarine;
        }
    </style>
</head>

<body>
    <div id="myapp">
        <h1>{{ title }}</h1>
        <div style="display:flex; flex-direction: row;">
            <p>{{ data }}</p>
            <p _if="$.hover">mouse hover detected</p>
        </div>
        <button _click="setalert('messaggio da evento')">{{ tasto }}</button>
        <div name="ciccio" _click="changetitle(e);"
            style="padding:1rem; margin:.5rem; cursor: pointer; background-color: blue; color: lightgray;">switch title
        </div>
        <button _on="click -> $.conto += 1" _if="$.conto > 5 -> disabled"> conto dinamico: {{ conto }}</button>
        <br />
        <br />
        <button _click="addItem()">aggiungi</button>
        <button _click="removeLast()">rimuovi</button>
        <div style="display:flex; flex-direction:row;">
            <ul _for="item in lista" _if="!($.conto % 2)" _sort="item.id desc">
                <li data-value="{{ item.id }}" name="{{ :index }}">{{ item.name }}</li>
            </ul>
            <p style="margin: 1rem;" _elseif="$.conto == 3">prova di continuità<br /> della logica if-else</p>
            <ul _for="item in semplice" _else _sort="item desc">
                <li>{{ item }} {{ :index }}</li>
            </ul>
        </div>
        <ol _for="item in lista" _filter="!(item.id % 2)">
            <li>{{ item.name }} - {{ conto }}</li>
        </ol>            
        <div _for="item in semplice">
            <span style="padding: .5rem; margin: 0 .5em; border-radius: 8px; background-color:azure;">{{ item }}</span>
        </div>

        <div class="usato" _if="$.tavolo.nuovo -> nuovo"
            style="border: solid 1px black; border-radius: 8px; padding: 1rem; margin: 1rem;">
            <h1>Il nostro tavolo</h1>
            <p><strong>tipologia di copertura: </strong>{{ tavolo.copertura }}</p>
            <p><strong>n° zampe: </strong>{{ tavolo.zampe }}</p>
            <button _on="click -> $.tavolo.nuovo = !$.tavolo.nuovo">
                <span _if="$.tavolo.nuovo">USA</span>
                <span _else>RINNOVA</span>
            </button>
        </div>
    </div>
    <script src="../SalsaVerde/salsaverde.global.js"></script>
    <script name="app_test" type="text/javascript">

        var myapp;
        openKiosk("myapp").reserve({
            data: {
                title: "Applicazione di prova",
                tasto: "Riproduci alert di sistema",
                data: new Date(),
                conto: 0,
                lista: [
                    { id: 1, name: "elemento 1" },
                    { id: 2, name: "elemento 2" },
                    { id: 3, name: "elemento 3" },
                    { id: 4, name: "elemento 4" }
                ],
                semplice: ["1 pillola", "6 pillola", "5 pillola"],
                hover: false,
                tavolo: {
                    zampe: 4,
                    copertura: "tovaglia",
                    materiale: "legno",
                    durezza: 10,
                    nuovo: false
                }
            },
            settings: {
                formatter: {
                    type: svenum.datatypes.date,
                    stamp: (value) => {
                        let _options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                        return value.toLocaleDateString("it-IT", _options);
                    }
                }
            }
        }).globalize({ myapp });

        function setAlert(messaggio) {
            svglobal.claim(messaggio);
        }
        function changeTitle(evt) {
            // alert(evt.target.getAttribute("name"));
            switch (myapp.dataset.title) {
                case "cambio titolo!": myapp.dataset.title = "Applicazione di prova"; break;
                case "Applicazione di prova": myapp.dataset.title = "cambio titolo!"; break;
            }
        }

        function addItem() {
            myapp.dataset.lista.push({ id: myapp.dataset.lista.length + 1, name: "elemento " + (myapp.dataset.lista.length + 1).toString() });
            myapp.dataset.semplice.push("ciao");
        }
        function removeLast() {
            myapp.dataset.lista.pop();
            myapp.dataset.semplice.pop();
        }

    </script>
</body>

</html>